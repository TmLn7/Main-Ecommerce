{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport jwtDecode from \"jwt-decode\";\nimport axios from \"axios\";\nimport { url, setHeaders } from \"./api\";\nconst initialState = {\n  token: localStorage.getItem(\"token\"),\n  name: \"\",\n  email: \"\",\n  _id: \"\",\n  isAdmin: false,\n  registerStatus: \"\",\n  registerError: \"\",\n  loginStatus: \"\",\n  loginError: \"\",\n  userLoaded: false\n};\nexport const registerUser = createAsyncThunk(\"auth/registerUser\", async (values, _ref) => {\n  let {\n    rejectWithValue\n  } = _ref;\n\n  try {\n    const token = await axios.post(`${url}/register`, {\n      username: values.username,\n      email: values.email,\n      password: values.password\n    });\n    localStorage.setItem(\"token\", token.data);\n    return token.data;\n  } catch (error) {\n    console.log(error.response.data);\n    return rejectWithValue(error.response.data);\n  }\n});\nexport const loginUser = createAsyncThunk(\"auth/loginUser\", async (values, _ref2) => {\n  let {\n    rejectWithValue\n  } = _ref2;\n\n  try {\n    const token = await axios.post(`${url}/login`, {\n      email: values.email,\n      password: values.password\n    });\n    localStorage.setItem(\"token\", token.data);\n    return token.data;\n  } catch (error) {\n    console.log(error.response);\n    return rejectWithValue(error.response.data);\n  }\n});\nexport const getUser = createAsyncThunk(\"auth/getUser\", async (id, _ref3) => {\n  let {\n    rejectWithValue\n  } = _ref3;\n\n  try {\n    const token = await axios.get(`${url}/user/${id}`, setHeaders());\n    localStorage.setItem(\"token\", token.data);\n    return token.data;\n  } catch (error) {\n    console.log(error.response);\n    return rejectWithValue(error.response.data);\n  }\n});\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    loadUser(state, action) {\n      const token = state.token;\n\n      if (token) {\n        const user = jwtDecode(token);\n        return { ...state,\n          token,\n          username: user.username,\n          email: user.email,\n          _id: user._id,\n          isAdmin: user.isAdmin,\n          userLoaded: true\n        };\n      } else return { ...state,\n        userLoaded: true\n      };\n    },\n\n    logoutUser(state, action) {\n      localStorage.removeItem(\"token\");\n      return { ...state,\n        token: \"\",\n        name: \"\",\n        email: \"\",\n        _id: \"\",\n        isAdmin: false,\n        registerStatus: \"\",\n        registerError: \"\",\n        loginStatus: \"\",\n        loginError: \"\"\n      };\n    }\n\n  },\n  extraReducers: builder => {\n    builder.addCase(registerUser.pending, (state, action) => {\n      return { ...state,\n        registerStatus: \"pending\"\n      };\n    });\n    builder.addCase(registerUser.fulfilled, (state, action) => {\n      if (action.payload) {\n        const user = jwtDecode(action.payload);\n        return { ...state,\n          token: action.payload,\n          name: user.name,\n          email: user.email,\n          _id: user._id,\n          isAdmin: user.isAdmin,\n          registerStatus: \"success\"\n        };\n      } else return state;\n    });\n    builder.addCase(registerUser.rejected, (state, action) => {\n      return { ...state,\n        registerStatus: \"rejected\",\n        registerError: action.payload\n      };\n    });\n    builder.addCase(loginUser.pending, (state, action) => {\n      return { ...state,\n        loginStatus: \"pending\"\n      };\n    });\n    builder.addCase(loginUser.fulfilled, (state, action) => {\n      if (action.payload) {\n        const user = jwtDecode(action.payload);\n        return { ...state,\n          token: action.payload,\n          name: user.name,\n          email: user.email,\n          _id: user._id,\n          isAdmin: user.isAdmin,\n          loginStatus: \"success\"\n        };\n      } else return state;\n    });\n    builder.addCase(loginUser.rejected, (state, action) => {\n      return { ...state,\n        loginStatus: \"rejected\",\n        loginError: action.payload\n      };\n    });\n    builder.addCase(getUser.pending, (state, action) => {\n      return { ...state,\n        getUserStatus: \"pending\"\n      };\n    });\n    builder.addCase(getUser.fulfilled, (state, action) => {\n      if (action.payload) {\n        const user = jwtDecode(action.payload);\n        return { ...state,\n          token: action.payload,\n          name: user.name,\n          email: user.email,\n          _id: user._id,\n          isAdmin: user.isAdmin,\n          getUserStatus: \"success\"\n        };\n      } else return state;\n    });\n    builder.addCase(getUser.rejected, (state, action) => {\n      return { ...state,\n        getUserStatus: \"rejected\",\n        getUserError: action.payload\n      };\n    });\n  }\n});\nexport const {\n  loadUser,\n  logoutUser\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","jwtDecode","axios","url","setHeaders","initialState","token","localStorage","getItem","name","email","_id","isAdmin","registerStatus","registerError","loginStatus","loginError","userLoaded","registerUser","values","rejectWithValue","post","username","password","setItem","data","error","console","log","response","loginUser","getUser","id","get","authSlice","reducers","loadUser","state","action","user","logoutUser","removeItem","extraReducers","builder","addCase","pending","fulfilled","payload","rejected","getUserStatus","getUserError","actions","reducer"],"sources":["/Users/tmln/Desktop/Main-Ecommerce/client/src/slices/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport jwtDecode from \"jwt-decode\";\nimport axios from \"axios\";\nimport { url, setHeaders } from \"./api\";\n\nconst initialState = {\n  token: localStorage.getItem(\"token\"),\n  name: \"\",\n  email: \"\",\n  _id: \"\",\n  isAdmin: false,\n  registerStatus: \"\",\n  registerError: \"\",\n  loginStatus: \"\",\n  loginError: \"\",\n  userLoaded: false,\n};\n\nexport const registerUser = createAsyncThunk(\n  \"auth/registerUser\",\n  async (values, { rejectWithValue }) => {\n    try {\n      const token = await axios.post(`${url}/register`, {\n        username: values.username,\n        email: values.email,\n        password: values.password,\n      });\n\n      localStorage.setItem(\"token\", token.data);\n\n      return token.data;\n    } catch (error) {\n      console.log(error.response.data);\n      return rejectWithValue(error.response.data);\n    }\n  }\n);\n\nexport const loginUser = createAsyncThunk(\n  \"auth/loginUser\",\n  async (values, { rejectWithValue }) => {\n    try {\n      const token = await axios.post(`${url}/login`, {\n        email: values.email,\n        password: values.password,\n      });\n\n      localStorage.setItem(\"token\", token.data);\n      return token.data;\n    } catch (error) {\n      console.log(error.response);\n      return rejectWithValue(error.response.data);\n    }\n  }\n);\n\nexport const getUser = createAsyncThunk(\n  \"auth/getUser\",\n  async (id, { rejectWithValue }) => {\n    try {\n      const token = await axios.get(`${url}/user/${id}`, setHeaders());\n\n      localStorage.setItem(\"token\", token.data);\n\n      return token.data;\n    } catch (error) {\n      console.log(error.response);\n      return rejectWithValue(error.response.data);\n    }\n  }\n);\n\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    loadUser(state, action) {\n      const token = state.token;\n\n      if (token) {\n        const user = jwtDecode(token);\n        return {\n          ...state,\n          token,\n          username: user.username,\n          email: user.email,\n          _id: user._id,\n          isAdmin: user.isAdmin,\n          userLoaded: true,\n        };\n      } else return { ...state, userLoaded: true };\n    },\n    logoutUser(state, action) {\n      localStorage.removeItem(\"token\");\n\n      return {\n        ...state,\n        token: \"\",\n        name: \"\",\n        email: \"\",\n        _id: \"\",\n        isAdmin: false,\n        registerStatus: \"\",\n        registerError: \"\",\n        loginStatus: \"\",\n        loginError: \"\",\n      };\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(registerUser.pending, (state, action) => {\n      return { ...state, registerStatus: \"pending\" };\n    });\n    builder.addCase(registerUser.fulfilled, (state, action) => {\n      if (action.payload) {\n        const user = jwtDecode(action.payload);\n        return {\n          ...state,\n          token: action.payload,\n          name: user.name,\n          email: user.email,\n          _id: user._id,\n          isAdmin: user.isAdmin,\n          registerStatus: \"success\",\n        };\n      } else return state;\n    });\n    builder.addCase(registerUser.rejected, (state, action) => {\n      return {\n        ...state,\n        registerStatus: \"rejected\",\n        registerError: action.payload,\n      };\n    });\n    builder.addCase(loginUser.pending, (state, action) => {\n      return { ...state, loginStatus: \"pending\" };\n    });\n    builder.addCase(loginUser.fulfilled, (state, action) => {\n      if (action.payload) {\n        const user = jwtDecode(action.payload);\n        return {\n          ...state,\n          token: action.payload,\n          name: user.name,\n          email: user.email,\n          _id: user._id,\n          isAdmin: user.isAdmin,\n          loginStatus: \"success\",\n        };\n      } else return state;\n    });\n    builder.addCase(loginUser.rejected, (state, action) => {\n      return {\n        ...state,\n        loginStatus: \"rejected\",\n        loginError: action.payload,\n      };\n    });\n    builder.addCase(getUser.pending, (state, action) => {\n      return {\n        ...state,\n        getUserStatus: \"pending\",\n      };\n    });\n    builder.addCase(getUser.fulfilled, (state, action) => {\n      if (action.payload) {\n        const user = jwtDecode(action.payload);\n        return {\n          ...state,\n          token: action.payload,\n          name: user.name,\n          email: user.email,\n          _id: user._id,\n          isAdmin: user.isAdmin,\n          getUserStatus: \"success\",\n        };\n      } else return state;\n    });\n    builder.addCase(getUser.rejected, (state, action) => {\n      return {\n        ...state,\n        getUserStatus: \"rejected\",\n        getUserError: action.payload,\n      };\n    });\n  },\n});\n\nexport const { loadUser, logoutUser } = authSlice.actions;\n\nexport default authSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}